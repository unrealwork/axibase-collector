<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Collector | NGINX Web Server Monitoring</title>
    <meta name="description" content="User manual and API reference for AxibaseÂ® Time Series Database">
    <link rel="shortcut icon" href="/docs/axibase-collector/favicon.ico">
    
    <link rel="stylesheet" href="/docs/axibase-collector/assets/css/117.styles.518f94bf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/docs/axibase-collector/" class="home-link router-link-active"><img src="/docs/axibase-collector/images/axibase_logo_green.gif" class="logo"><span class="site-name can-hide">
      Collector
    </span></a><div class="links"><nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Jobs</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/aws.html" class="nav-link">AWS</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/docker.html" class="nav-link">Docker</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/file.html" class="nav-link">File</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/http.html" class="nav-link">HTTP</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/icmp.html" class="nav-link">ICMP</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/jdbc.html" class="nav-link">JDBC</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/jmx.html" class="nav-link">JMX</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/json.html" class="nav-link">JSON</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/kafka.html" class="nav-link">Kafka</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/ovpm.html" class="nav-link">OVPM</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/pi.html" class="nav-link">PI</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/snmp.html" class="nav-link">SNMP</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/socrata.html" class="nav-link">Socrata</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/tcp.html" class="nav-link">TCP</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Data Sources</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/jdbc-data-source.html" class="nav-link">Database</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/atsd-server-connection.html#http-pool" class="nav-link">HTTP Pool</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/kafka-consumer.html" class="nav-link">Kafka Consumer</a></li></ul></div></div><div class="nav-item"><a href="/docs/axibase-collector/#examples" class="nav-link">Examples</a></div><!----></nav><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Jobs</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/aws.html" class="nav-link">AWS</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/docker.html" class="nav-link">Docker</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/file.html" class="nav-link">File</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/http.html" class="nav-link">HTTP</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/icmp.html" class="nav-link">ICMP</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/jdbc.html" class="nav-link">JDBC</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/jmx.html" class="nav-link">JMX</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/json.html" class="nav-link">JSON</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/kafka.html" class="nav-link">Kafka</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/ovpm.html" class="nav-link">OVPM</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/pi.html" class="nav-link">PI</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/snmp.html" class="nav-link">SNMP</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/socrata.html" class="nav-link">Socrata</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/tcp.html" class="nav-link">TCP</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Data Sources</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/jdbc-data-source.html" class="nav-link">Database</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/atsd-server-connection.html#http-pool" class="nav-link">HTTP Pool</a></li><li class="dropdown-item"><!----><a href="/docs/axibase-collector/jobs/kafka-consumer.html" class="nav-link">Kafka Consumer</a></li></ul></div></div><div class="nav-item"><a href="/docs/axibase-collector/#examples" class="nav-link">Examples</a></div><!----></nav><ul class="sidebar-links"><li><a href="/docs/axibase-collector/" class="sidebar-link">Axibase Collector</a></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Installation</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Updating</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Administration</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Job's Configuration</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Automation</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="nginx-web-server-monitoring"><a href="#nginx-web-server-monitoring" aria-hidden="true" class="header-anchor">#</a> NGINX Web Server Monitoring</h1><h2 id="overview"><a href="#overview" aria-hidden="true" class="header-anchor">#</a> Overview</h2><p>This document describes how to collect connection and request metrics from an NGINX web server for long-term retention and monitoring in the Axibase Time Series Database.</p><p>The process involves enabling the NGINX status page and configuring Axibase Collector to poll and upload this page every 5 seconds for parsing in ATSD.</p><h2 id="requirements"><a href="#requirements" aria-hidden="true" class="header-anchor">#</a> Requirements</h2><ul><li>NGINX server with <a href="http://nginx.org/en/docs/http/ngx_http_stub_status_module.html" target="_blank" rel="noopener noreferrer">ngx_http_stub_status_module</a> enabled.</li><li><a href="/docs/axibase-collector/" class="router-link-active">Axibase Collector</a> for scheduled polling of the NGINX status page.</li><li><a href="https://axibase.com/docs/atsd/installation/" target="_blank" rel="noopener noreferrer">Axibase Time Series Database</a> as a centralized data repository.</li></ul><h2 id="nginx-server-configuration"><a href="#nginx-server-configuration" aria-hidden="true" class="header-anchor">#</a> NGINX Server Configuration</h2><p>Follow the steps outlined in the <a href="/docs/axibase-collector/jobs/examples/nginx/nginx-configure.html">NGINX server configuration guide</a> to enable metrics on its status page.</p><p>The status page returns connection statistics in an unstructured/malformed format, which is parsed by ATSD with <a href="https://axibase.com/docs/atsd/parsers/csv/#schema-based-parsing" target="_blank" rel="noopener noreferrer">RFC 7111</a> selectors using whitespace as a separator.</p><pre class="language-text"><code>Active connections: 291
server accepts handled requests
 16630948 16630948 31070465
Reading: 6 Writing: 179 Waiting: 106
</code></pre><pre class="language-javascript"><code><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;#row=1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;#col=3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
<span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
<span class="token function">metric</span><span class="token punctuation">(</span><span class="token function">cell</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token function">cell</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span>col<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">cell</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span>col<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
</code></pre><h2 id="import-nginx-csv-parser-configuration-into-atsd"><a href="#import-nginx-csv-parser-configuration-into-atsd" aria-hidden="true" class="header-anchor">#</a> Import NGINX CSV Parser Configuration into ATSD</h2><ul><li>Login into the ATSD web interface.</li><li>Open the <strong>Configuration:Parsers CSV</strong> page. Click Import.</li><li>Import <a href="./configs/nginx-atsd-csv-parser.xml">CSV parser</a> for the NGINX status page.</li><li>The parser splits status page content into cells and assembles series commands from extracted cell values.<br>In addition, it creates a derived metric <code>unhandled_percent</code> equal to <code>100*(1-handled/accepted)</code>.</li></ul><h2 id="configure-jobs-in-axibase-collector"><a href="#configure-jobs-in-axibase-collector" aria-hidden="true" class="header-anchor">#</a> Configure Jobs in Axibase Collector</h2><p>Axibase Collector will poll the NGINX status page every 5 seconds and upload the downloaded file into ATSD for parsing. Moreover, Axibase Collector will try to establish a TCP connection with the same period to check availability of the server.</p><ul><li>Login into Axibase Collector web interface</li></ul><h3 id="create-item-list-for-nginx-servers"><a href="#create-item-list-for-nginx-servers" aria-hidden="true" class="header-anchor">#</a> Create Item List for NGINX servers</h3><ul><li>Open the <strong>Collections:Item Lists</strong> page.</li><li>Add a new TEXT <a href="/docs/axibase-collector/collections.html">Item List</a> named <strong>nginx-servers</strong>, containing DNS names or IP addresses of the monitored NGINX servers, one server per line. Make sure that each server on the list is accessible on the specified protocol and port and exposes the status page on the same path: <code>/nginx_status</code>. If the protocols and ports are different, move the entire url to the list and set the Path field equal to the <code>${ITEM}</code> placeholder.</li><li><strong>Save</strong> the list.</li></ul><p><img src="/docs/axibase-collector/assets/img/nginx-server-list.41e2d5e9.png" alt="Server list example"></p><h3 id="import-jobs"><a href="#import-jobs" aria-hidden="true" class="header-anchor">#</a> Import Jobs</h3><ul><li>Import the <a href="./configs/nginx-collector-jobs.xml">nginx-collector-jobs.xml</a> job on the <strong>Jobs:Import</strong> page.</li><li>Open the <code>nginx-statistics</code> FILE job.</li><li>If the 'Storage' drop-down is set to <code>None</code>, select the target ATSD server.</li><li>Set Status to Enabled.</li><li><strong>Save</strong> the job.</li><li>Open the <code>nginx-connect-check</code> TCP job.</li><li>If the 'Storage' drop-down is set to <code>None</code>, select the target ATSD server.</li><li>Set Status to Enabled.</li><li><strong>Save</strong> the job.</li></ul><h3 id="validate-data-availability"><a href="#validate-data-availability" aria-hidden="true" class="header-anchor">#</a> Validate Data Availability</h3><ul><li>Open the <code>nginx-status</code> configuration in the <code>nginx-statistics</code> job.</li><li>Click Test to verify processing.</li></ul><p><img src="data:image/png;base64,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" alt="NGINX test"></p><ul><li>Open the <code>nginx-connect</code> configuration in the <code>nginx-connect-check</code> job.</li><li>Click Test to verify connectivity to the target server. <br>If TCP connection was successful, the <code>tcp-connect</code> metric returns a 0 exit code.</li></ul><p><img src="/docs/axibase-collector/assets/img/nginx-collector-test-TCP.13439ad5.png" alt="NGINX test"></p><ul><li>Login into the ATSD web interface.</li><li>Open the Metrics tab and apply the <code>nginx*</code> name mask to view <code>nginx</code> metrics received by ATSD.</li><li>Click on the Series link and check that metrics are present for each server in the <strong>nginx-servers</strong> list.</li></ul><p><img src="/docs/axibase-collector/assets/img/nginx-metrics-list.41241a8d.png" alt="NGINX metrics"></p><h3 id="nginx-status-page-metrics"><a href="#nginx-status-page-metrics" aria-hidden="true" class="header-anchor">#</a> NGINX Status Page Metrics</h3><table><thead><tr><th style="text-align:center">Metric</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:center">Active connection</td><td style="text-align:left">The current number of active client connections, including Waiting connections.</td></tr><tr><td style="text-align:center">Server accepts</td><td style="text-align:left">The total number of accepted client connections.</td></tr><tr><td style="text-align:center">Server handled</td><td style="text-align:left">The total number of handled connections.<br> The parameter is lower than Server accepts if the resource limits have been reached (for example, the <code>worker_connections</code> limit).</td></tr><tr><td style="text-align:center">Server requests</td><td style="text-align:left">The total number of client requests.</td></tr><tr><td style="text-align:center">Reading</td><td style="text-align:left">The current number of connections where nginx is reading the request header.</td></tr><tr><td style="text-align:center">Writing</td><td style="text-align:left">The current number of connections where nginx is writing the response back to the client.</td></tr><tr><td style="text-align:center">Waiting</td><td style="text-align:left">The current number of idle client connections waiting for a request.</td></tr></tbody></table><h2 id="viewing-data-in-atsd"><a href="#viewing-data-in-atsd" aria-hidden="true" class="header-anchor">#</a> Viewing Data in ATSD</h2><h2 id="metrics"><a href="#metrics" aria-hidden="true" class="header-anchor">#</a> Metrics</h2><p>List of collected <a href="/docs/axibase-collector/jobs/examples/nginx/nginx-basic-server-metrics.html">NGINX server metrics</a>.</p><h2 id="entity-group"><a href="#entity-group" aria-hidden="true" class="header-anchor">#</a> Entity Group</h2><ul><li>Open <strong>Admin:Entity Groups</strong>, click the [Import] button, and upload <a href="./configs/nginx_entity_group.xml">nginx_basic_entity_group.xml</a>.</li><li>Select imported <code>nginx-servers</code> group.</li><li>Verify that the group contains your NGINX servers.</li></ul><h2 id="portal"><a href="#portal" aria-hidden="true" class="header-anchor">#</a> Portal</h2><ul><li>Open <strong>Configuration: Portals</strong>, click the [Import] button, and upload <a href="./configs/nginx_portal.xml">nginx_portal.xml</a>.</li><li>Click the <strong>Assign</strong> link and associate the portal with the entity group you created earlier.</li><li>Open the <em>Entity</em> tab, find the NGINX servers you would like to see information about, and click on its portal icon.</li></ul><p><img src="/docs/axibase-collector/assets/img/nginx-portal-selection.7d975261.png" alt><a href="http://apps.axibase.com/chartlab/966f33e4" target="_blank" rel="noopener noreferrer">Basic NGINX Status portal example</a><img src="/docs/axibase-collector/assets/img/nginx-portal-basic.81501620.png" alt="Basic NGINX Status portal"></p><h2 id="notifications"><a href="#notifications" aria-hidden="true" class="header-anchor">#</a> Notifications</h2><p>You can monitor key NGINX statistics by creating a rule in ATSD rule engine to send an email notification in case of abnormal conditions.</p><p>For example, you can send an email if the average <em>Active Connections</em> count over the last 15 minutes on a target NGINX server drops below the specified threshold.</p><h3 id="setting-up-mail-client"><a href="#setting-up-mail-client" aria-hidden="true" class="header-anchor">#</a> Setting up Mail Client</h3><ul><li>Configure <a href="https://axibase.com/docs/atsd/administration/mail-client.html" target="_blank" rel="noopener noreferrer">Mail Client</a>.</li></ul><h3 id="import-rules"><a href="#import-rules" aria-hidden="true" class="header-anchor">#</a> Import rules</h3><ul><li>Download an <a href="./configs/nginx_notification_rules.xml">xml file</a> containing the rules.</li><li>Open the <strong>Configuration: Rules</strong> page.</li><li>Click <em>Import</em> and attach the <code>nginx_notification_rules.xml</code> file.</li><li>Open created rules in the Rule Editor and change the recipient address on the <em>Email Notifications</em> tab.</li><li>These rules will automatically apply to all NGINX servers monitored by Axibase Collector.</li></ul><p>The following rules are provided in the <code>nginx_notification_rules.xml</code> file:</p><table><thead><tr><th style="text-align:center"><strong>Rule</strong></th><th style="text-align:left"><strong>Description</strong></th></tr></thead><tbody><tr><td style="text-align:center">nginx_unhandled_percent_high</td><td style="text-align:left">Raise an alert when an NGINX server unhandled connection percentage is above 2%.</td></tr><tr><td style="text-align:center">nginx_active_connections_low</td><td style="text-align:left">Raise an alert when an NGINX server average Active Connection count is below 10 over the last 15 minutes.</td></tr><tr><td style="text-align:center">nginx_active_connections_heartbeat</td><td style="text-align:left">Raise an alert when status page statistics are no longer being received by ATSD.<br> Check that the server is reachable and Axibase Collector job is running.</td></tr><tr><td style="text-align:center">nginx_tcp_heartbeat</td><td style="text-align:left">Raise an alert when the TCP connect metric is no longer being received by ATSD or if the TCP connect metric contains error codes.<br>Check that the server is reachable and Axibase Collector job is running.</td></tr></tbody></table><p>To create your own rules, refer to <a href="https://axibase.com/docs/atsd/rule-engine/" target="_blank" rel="noopener noreferrer">Rule Engine documentation</a>.</p></div><div class="content edit-link"><a href="https://github.com/axibase/axibase-collector/edit/master//jobs/examples/nginx/README.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><!----></div></div></div>
    <script src="/docs/axibase-collector/assets/js/52.e1c18067.js" defer></script><script src="/docs/axibase-collector/assets/js/app.2470ced7.js" defer></script>
  </body>
</html>
